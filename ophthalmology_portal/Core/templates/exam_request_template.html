{% extends "base_patient.html" %}
{% block content %}
<div class="flex justify-center items-center min-h-screen bg-blue-100">
  <div class="bg-white rounded-xl shadow-xl w-4/5 max-w-5xl p-8">

    <!-- Title -->
    <h1 class="text-3xl font-bold text-center text-sky-600 mb-1">eye-c-u</h1>
    <hr class="my-4">
    <h2 class="text-xl font-semibold text-center text-gray-800 mb-8">Appointment Request</h2>

    <form method="post">
      {% csrf_token %}

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

        <!-- Left Column: Doctor + Time -->
        <div class="space-y-4">
          <div>
            <label for="doctor" class="block font-medium text-gray-700 mb-1">Select Doctor</label>
            <select id="doctor" name="doctor" hx-trigger="change" hx-indicator=".htmx-indicator" hx-get="{% url 'exam_request' %}" hx-target="#time" hx-include="[name='date']" class="w-4/5 border border-gray-300 rounded px-3 py-2">
              <option value="">-------</option>
              {% for doctor in doctors %}
                <option value="{{ doctor.id }}">{{ doctor }}</option>
              {% endfor %}
            </select>
          </div>

          <div>
            <label class="block font-medium text-gray-700 mb-1">Select Time</label>
            <section id="time" class="h-60 overflow-y-auto border rounded px-3 py-2">
              {% include "time_submission.html" %}
            </section>
          </div>
        </div>

        <!-- Right Column: Date + Reason -->
        <div class="space-y-4">
          <div>
            <label for="date" class="block font-medium text-gray-700 mb-1">Select Date</label>
            <input type="date" id="date" name="date" min="{{ minimum }}" max="{{ maximum }}"
              hx-trigger="change" hx-indicator=".htmx-indicator" hx-get="{% url 'exam_request' %}" hx-target="#time" hx-include="[name='doctor']"
              class="w-4/5 border border-gray-300 rounded px-3 py-2">
          </div>

          <div>
            <label for="reason_for_visit" class="block font-medium text-gray-700 mb-1">Reason for Visit</label>
            <textarea id="reason_for_visit" name="reason_for_visit" rows="4" placeholder="Describe your symptoms or request..."
              class="w-4/5 border border-gray-300 rounded px-3 py-2"></textarea>
          </div>
        </div>

      </div>

      <div class="flex justify-center mt-8">
        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition">Submit Request</button>
      </div>

      {% if messages %}
        <div class="text-center text-red-600 mt-4 text-sm">
          {% for message in messages %}
            {{ message.message }}<br>
          {% endfor %}
        </div>
      {% endif %}
    </form>
  </div>
</div>
{% endblock %}
